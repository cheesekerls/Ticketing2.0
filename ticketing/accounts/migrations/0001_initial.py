<<<<<<< HEAD
<<<<<<< HEAD
=======
# Generated by Django 5.2.5 on 2025-11-14 05:12
>>>>>>> counter

=======
>>>>>>> f7ab577c541ae732dae46b59b650735189afc0be
import django.db.models.deletion
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('departments', '0001_initial'),
    ]

    operations = [
        # ✅ COUNTER MODEL
        migrations.CreateModel(
<<<<<<< HEAD
=======
            name='Counter',
            fields=[
                ('counter_id', models.AutoField(primary_key=True, serialize=False)),
                ('counter_number', models.CharField(max_length=100)),
                ('department', models.ForeignKey(
                    on_delete=django.db.models.deletion.CASCADE,
                    related_name='accounts_counters',
                    to='departments.department'
                )),
                ('service', models.ForeignKey(
                    blank=True,
                    db_column='service_id',
                    null=True,
                    on_delete=django.db.models.deletion.CASCADE,
                    related_name='accounts_counters_services',
                    to='services.service'
                )),
                ('ticket', models.ForeignKey(
                    on_delete=django.db.models.deletion.CASCADE,
                    related_name='accounts_counters_tickets',
                    to='tickets.ticket'
                )),
            ],
        ),

        # ✅ EMPLOYEE MODEL
        migrations.CreateModel(
>>>>>>> f7ab577c541ae732dae46b59b650735189afc0be
            name='Employee',
            fields=[
                ('employee_id', models.AutoField(primary_key=True, serialize=False)),
                ('name', models.CharField(max_length=100)),
                ('email', models.EmailField(max_length=254, unique=True)),
                ('position', models.CharField(max_length=50)),
                ('password', models.CharField(blank=True, max_length=255, null=True)),
                ('password_reset_token', models.CharField(blank=True, max_length=255, null=True)),
                ('is_active', models.BooleanField(default=True)),
<<<<<<< HEAD
                ('department', models.ForeignKey(
                    null=True,
                    on_delete=django.db.models.deletion.CASCADE,
                    to='departments.department'
                )),
=======
            ],
        ),
        migrations.CreateModel(
            name='Log',
            fields=[
                ('log_id', models.AutoField(primary_key=True, serialize=False)),
            ],
        ),
        migrations.CreateModel(
            name='UserProfile',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('role', models.CharField(choices=[('admin', 'Admin'), ('moderator', 'Moderator'), ('counter', 'Counter')], default='admin', max_length=10)),
>>>>>>> counter
            ],
        ),

        # ✅ AUTHUSER MODEL
        migrations.CreateModel(
            name='AuthUser',
            fields=[
                ('user_id', models.AutoField(primary_key=True, serialize=False)),
<<<<<<< HEAD
                ('department', models.ForeignKey(
                    on_delete=django.db.models.deletion.CASCADE,
                    to='departments.department'
                )),
                ('employee', models.ForeignKey(
                    on_delete=django.db.models.deletion.CASCADE,
                    to='accounts.employee'
                )),
=======
                ('department', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='departments.department')),
>>>>>>> counter
            ],
        ),

        # ✅ LOG MODEL
        migrations.CreateModel(
            name='Counter',
            fields=[
<<<<<<< HEAD
                ('log_id', models.AutoField(primary_key=True, serialize=False)),
                ('employee', models.ForeignKey(
                    on_delete=django.db.models.deletion.CASCADE,
                    to='accounts.employee'
                )),
                ('ticket', models.ForeignKey(
                    on_delete=django.db.models.deletion.CASCADE,
                    to='tickets.ticket'
                )),
            ],
        ),

        # ✅ USERPROFILE MODEL
        migrations.CreateModel(
            name='UserProfile',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('role', models.CharField(
                    choices=[
                        ('moderator', 'Moderator'),
                        ('admin', 'Admin'),
                        ('staff', 'Staff')
                    ],
                    default='moderator',
                    max_length=10
                )),
                ('department', models.ForeignKey(
                    blank=True,
                    null=True,
                    on_delete=django.db.models.deletion.SET_NULL,
                    to='departments.department'
                )),
                ('employee', models.ForeignKey(
                    blank=True,
                    null=True,
                    on_delete=django.db.models.deletion.SET_NULL,
                    to='accounts.employee'
                )),
                ('user', models.OneToOneField(
                    on_delete=django.db.models.deletion.CASCADE,
                    related_name='userprofile',
                    to=settings.AUTH_USER_MODEL
                )),
            ],
        ),

        # ✅ UNIQUE CONSTRAINT ON EMPLOYEE
        migrations.AddConstraint(
            model_name='employee',
            constraint=models.UniqueConstraint(
                fields=['department'],
                condition=models.Q(position='Admin'),
                name='unique_admin_per_department',
            ),
=======
                ('counter_id', models.AutoField(primary_key=True, serialize=False)),
                ('name', models.CharField(max_length=100)),
                ('email', models.EmailField(blank=True, max_length=254, null=True, unique=True)),
                ('password', models.CharField(blank=True, max_length=255, null=True)),
                ('password_reset_token', models.CharField(blank=True, max_length=255, null=True)),
                ('counter_number', models.CharField(max_length=100)),
                ('status', models.CharField(default='Idle', max_length=20)),
                ('department', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='departments.department')),
                ('services', models.ManyToManyField(blank=True, to='departments.service')),
            ],
            options={
                'verbose_name': 'Counter',
                'verbose_name_plural': 'Counters',
            },
>>>>>>> counter
        ),
    ]
